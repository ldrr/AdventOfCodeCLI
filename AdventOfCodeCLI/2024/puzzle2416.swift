//
//  puzzle2416.swift
//  AdventOfCodeCLI
//
//  Created by Christoph Lederer on 16.12.24.
//

struct PriorityQueue<Element: Hashable> {
    private var elements: [(Element, Int)] = []

    mutating func enqueue(_ element: Element, priority: Int) {
        elements.append((element, priority))
        elements.sort { $0.1 < $1.1 } // Sort by cost
    }

    mutating func dequeue() -> Element? {
        return elements.isEmpty ? nil : elements.removeFirst().0
    }

    var isEmpty: Bool {
        return elements.isEmpty
    }

    var count: Int {
        elements.count
    }
}

class Puzzle2416: CustomStringConvertible {

    var description: String {
        var desc = ""
        for y in 0..<plan.count {
            for x in 0..<plan[0].count {
                desc.append(plan[y][x].rawValue)
            }
            desc.append("\n")
        }
        return desc
    }

    enum Tile: Character {
        case wall = "#"
        case empty = "."
        case start = "S"
        case end = "E"
        case visited = "O"
    }

    struct Pos: Hashable, CustomStringConvertible {
        var description: String {
            "(\(x)/\(y))"
        }

        var x: Int, y: Int

        func `in`(direction: Direction) -> Pos {
            switch direction {
            case .left:
                return Self(x: self.x - 1, y: self.y)
            case .right:
                return Self(x: self.x + 1, y: self.y)
            case .up:
                return Self(x: self.x, y: self.y - 1)
            case .down:
                return Self(x: self.x, y: self.y + 1)
            }
        }
    }

    enum Direction: Int, CaseIterable, Hashable {
        case up, right, down, left
    }

    struct Vector: Hashable {
        let pos: Pos
        let direction: Direction

        init(_ pos: Pos, _ dir: Direction) {
            self.pos = pos
            self.direction = dir
        }
    }

    var plan: [[Tile]]
    var start: Pos!, end: Pos!
    var costMap: [Pos: Int] = [:]

    func tile(at pos: Pos) -> Tile {
        self.plan[pos.y][pos.x]
    }

    func set(tile: Tile, at pos: Pos) {
        self.plan[pos.y][pos.x] = tile
    }

    init(input: String) {
        self.plan = input.components(separatedBy: "\n").map({ $0.map {
            Tile(rawValue: $0)!
        } })
        for y in 0..<plan.count {
            for x in 0..<plan[0].count {
                switch plan[y][x] {
                case .start:
                    self.start = Pos(x: x, y: y)
                case .end:
                    self.end = Pos(x: x, y: y)
                default:
                    break
                }
            }
        }
    }

    func rotationCost(current: Direction, target: Direction) -> Int {
        return current == target ? 0 : 1000
    }

    func dijkstra() -> Int? {
        let rows = plan.count
        let cols = plan[0].count
        var pq = PriorityQueue<Vector>()
        pq.enqueue(Vector(start, .right), priority: 0)
        costMap[start] = 0

        while !pq.isEmpty {
            guard let vector = pq.dequeue() else { break }
            let currentCost = costMap[vector.pos, default: Int.max]

            if vector.pos == self.end { return currentCost }

            for direction in Direction.allCases {
                let rotationCostValue = rotationCost(current: vector.direction, target: direction)
                let (dx, dy): (Int, Int)
                switch direction {
                case .up: dx = 0; dy = -1
                case .down: dx = 0; dy = 1
                case .left: dx = -1; dy = 0
                case .right: dx = 1; dy = 0
                }

                let next = Pos(x: vector.pos.x + dx, y: vector.pos.y + dy)
                guard next.x >= 0, next.x < cols, next.y >= 0, next.y < rows, plan[next.y][next.x] != .wall else {
                    continue // Skip invalid or blocked positions
                }

                let newCost = currentCost + moveCost(from: vector.pos, to: next) + rotationCostValue

                if newCost < costMap[next, default: Int.max] {
                    costMap[next] = newCost
                    pq.enqueue(Vector(next, direction), priority: newCost)
                }
            }
        }

        return nil // If no path was found
    }

    func part1() -> Int {
        return dijkstra() ?? -1
    }
}

func puzzle2416() {
    let puzzle = Puzzle2416(input: shortPuzzle)
    print(puzzle.part1())
}

private let shortPuzzle = """
########
#.....E#
#..#.###
#.....##
##.#..##
#S....##
########
"""
private let data2 = """
###############
#.......#....E#
#.#.###.#.#.#.#
#.....#.#.....#
#.###.#####.###
#.#.#.......#.#
#.#.#####.###.#
#...........#.#
###.#.#####.#.#
#...#.....#.#.#
#.#.#.###.#.#.#
#.....#...#.#.#
#.###.#.#.#.#.#
#S..#.....#...#
###############
"""

private let data1 = """
#################
#...#...#...#..E#
#.#.#.#.#.#.#.#.#
#.#.#.#...#...#.#
#.#.#.#.###.#.#.#
#...#.#.#.....#.#
#.#.#.#.#.#####.#
#.#...#.#.#.....#
#.#.#####.#.###.#
#.#.#.......#...#
#.#.###.#####.###
#.#.#...#.....#.#
#.#.#.#####.###.#
#.#.#.........#.#
#.#.#.#########.#
#S#.............#
#################
"""

private let data = """
#############################################################################################################################################
#.....#.........#.#.........#.........#.......#.................................#...#.....#.......#.......#.....#.......#..................E#
#.###.#.#.#####.#.#.#####.###.#####.#.#.#####.#.#########.#.###.#.###.#####.#.#.#.###.#.###.#.#.#.#.#.###.#.###.#.#.###.#.#########.#####.###
#...#...#...#.....#.....#.#...#.....#.#.......................#.................#.....#.....#.#...#.#.#...#.#.#...#.#...#.#...#.........#...#
###.#.###.#.#.#########.#.#.###.#####.#.#.#.#.#.###.#.###.###.###.#.#.#.#.#.#.#######.###.###.#####.#.#####.#.#####.###.#.#.#.###.#.###.###.#
#...#...#.........................#...#.#.#...#...#.#.......#.#...#...#.#.#.#.....#.....#...#.....#.#.............#...#.#.#.#...#.#...#...#.#
#.#####.#.#.#####.#.###.#####.###.#.###.#.#.###.#.#.#.###.###.#.#.#.###.#.#.#.#.#.#.#.#.#####.#.#.#.###########.#####.###.#.###.#.###.#####.#
#.#.....#.#.#.....#.....#...#...#.......#.#.#...#...#...#.#...#.#...#...#.#.....#...#.#.......#.#.#.#.....#...#.#...#.......#...#.#...#...#.#
#.#.###.#.###.###########.#.#######.#####.###.#.#########.#.#####.###.###.#.#.#######.#######.#.#.#.#.###.#.#.###.#.#########.#.###.#.#.#.#.#
#.#.....#...#.............#...#.......#...#.....................#.#.#.#.#.........#...#.....#.#...........#.#.....#...................#.#.#.#
#.###.#.###.#####.#.#.#######.#.###.#.#.#.#.#######.###.#.#####.#.#.#.#.#.#.#.###.#.#.#.#####.#.#.#.###.#.#.###########.#####.#.###.###.#.#.#
#...#.#...#.........#.#...#...#...#.....#.#...#...#.#...#.....#.....#.#.......#...#.#...#...#.#.#.........#...#.#.......#...#...#...#...#...#
###.###.#.###########.###.#.#####.#.#.#######.#.#.#.###.###.#.#.#.###.#.#.#.###.###.#.###.#.#.#.#############.#.#.#######.#.#.#.###.#.###.#.#
#...#.......#...#.....#...#.#.....#...#.....#...#.#...#.....#.#.....#.#.#.#.#...#.........#...#...#.........#.#...........#.......#.#...#...#
#.###.#.###.###.#.#####.###.#.#####.###.###.#####.###.#####.#####.#.#.###.#.#.###.###.###.###.###.#.#######.#.#.#########.###.#.#.#.###.#####
#.#...#.........#.#.........#.#.......#...#.....#.....#...#.#...#...#.....#.#...#.....#.....#.#...#.#.....#.#.#.#.#.....#.#...#...#...#.....#
#.###.#.#######.#.#####.#####.#.###.#.###.#.###.#.#####.#.###.#.#.#.#######.###.###.###.###.#.#####.#.###.#.#.#.#.#.###.###.#.#.###.#######.#
#...#.....#...#.#.....#.#...#...#...#...#.#.#...#.#.....#.....#.#.......#.....#.......#.#.#.#.....#.#...#.....#...#.#.#.....#.#.#...#.....#.#
###.#.#.#.#.#.#.#####.#.#.#.#####.#.#.###.#.#####.#.###########.#######.#.#.#.#######.#.#.#.#####.#.###.###########.#.#######.#.#####.###.#.#
#.#.#...#.#.#...#...#.#.#.#.......#...#...#.......#...#.......#.#.......#.#.......#.#.#...#.....#.#.#...#.....#.....#.......#.#.......#...#.#
#.#.#####.#######.#.#.#.#.#.#####.###.#.#####.#######.#.###.###.#.#######.#.#.###.#.#.###.#####.#.#.#.###.###.#.#########.#.#.#.#######.###.#
#.................#.#.#.#.#.#...#.....#...#.#.........#.#.......#.#.......#.#...#.#.#.....#.#...#.#.#.#...#.#...#.....#...#.#.........#.#...#
#.#####.#.#######.#.#.#.#.###.#.#########.#.#.#########.#.#.###.#.#.#######.#.###.#.#.###.#.#.###.#.###.###.#######.#.#.###.###.#####.#.#.#.#
#.....#.#.......#.#.#.#...#...#.....#.......#...#.....#.#.........#.....#...#.....#.#.......#.#.#.#...#...#.......#.#...#.....#.....#.#.....#
#.#.###.#####.#.###.#.#####.#######.#.#.#######.#.#####.#.#.#####.#####.###.#.#####.#######.#.#.#.#.#.###.#.###.#.#.#.#####.###.#.#.#.#####.#
#.....#...#...#.....#...#...#...#...#.#.#.......#.#.....#.#.#...#.....#.....#.#.......#.....#.#.#.......#.#...#.....#.#...#.....#.#.#.....#.#
#.#.#.###.#.#######.###.#.#####.#.###.#.#.#######.#.#.#.#.#.###.#####.#######.#######.#.###.#.#.#######.#.###.#.#####.#.#.#.#.###.#.#####.#.#
#.#.#...#...#.....#...#.#.#...#.#.......#.#...#.....#...#.#...#.....#.......#...#...#.#.......#.....#...#...#.#.#...#.#.#...#.....#.....#.#.#
#.#.#.#########.###.###.#.#.#.#.#####.###.#.#.#.#############.#.###.#######.###.#.#.#.#.###.#######.#.#.###.#.###.#.###.#####.#########.#.###
#...#...........#...#...#...#...#...#.....#.#.#.#.............#.#...#.....#...#.#.#...#...#.#.....#...#...#.#...#.#...#.#...#.#.......#.#...#
###.###.#########.###.###.#####.#.###.#######.#.###.#####.#.#####.###.#.#####.#.#.#######.###.###.###.#.#.#.#.#.#.###.#.#.#.#.#.#####.#.###.#
#.....#.......#...#...#.......#.#...#.#.......#...#.#.#...#.#...#.....#.......#.#...#...#...#...#...#.#.#.#.#.#.....#...#.#.#...#.#...#.#...#
#.#.#####.###.#.###.###.#.#####.#.#.#.###.###.###.#.#.#.#.###.#.#.#####.###.#.#.###.#.#.###.#.#####.#.#.###.#.###########.#.#.###.#.#####.#.#
#.#.....#...#...#...#...#.#.....#.#.#...#.#.....#.#.#.#.#.#...#.......#.......#.......#...#.#.#.....#...#...#...#.........#.#.....#.....#.#.#
###.###.#####.###.###.###.#.#######.###.#.#######.#.#.#.#.#.#########.#.#########.#.#####.#.#.#.###.#####.###.#.#.#.#####.#.###########.#.###
#...#.#.....#...#...#.#...#...#...#.#...#.........#...#.#.#.#.......#.#.#.....#...#.....#.#...#.........#.#...#.#.#.#.....#.........#...#...#
#.###.#####.###.###.#.#.#####.#.#.#.#.###.#############.###.###.#####.#.#.###.#.#####.###.#############.#.#.#.###.#.#.###.#########.#.#.###.#
#...#.......#.....#...#.........#.#.#.#...#...#.......#.#...#.......#.#.#...#.#.#.....#...#.....#.#...#.#.#.#.#...#.#...#...#.#.......#.#...#
###.#.###########.###############.#.#.#.###.#.#.###.#.#.#.###.#.#.#.#.###.#.#.#.#.#####.#.#.###.#.#.#.#.#.#.#.#.#####.#.###.#.#.#########.###
#...#...........#.#.............#.#.#.#...#.#...#.#.#...#.#...#.#.#...#...#.#...#.#...#.#...#.#.#...#.#...#...#.#.......#...#.....#.....#...#
#.#############.#.#.#####.#####.#.#.#.#.#.#.#####.#.#####.###.###.###.#.###.#######.#.#.#####.#.#####.#####.#.#.#.#######.#######.#.###.###.#
#.#...#.........#.#...#.#.....#.#...#.#.#.#.......#.....#.#...#...#...#.....#.......#...#...#...........#.....#.#.#.....#.......#.#.#.#.#...#
#.###.#.#########.###.#.#.###.#.#.###.#.#.###.#.#######.#.#.#.#.###.#######.###.#########.###.###.#####.#.###.#.#.#.#.#.#######.#.#.#.#.#.###
#...#.#.........#.#...#.#...#...#.#...#.#...#.#.......#...#.#...#.#.#.....#.....#...#.........#...#...#.#.#.#.#.....#.#...#.....#.#.....#...#
#.#.#.###.###.###.#.###.###.#######.###.###.###.#####.#.###.#.###.#.#.###.#######.###.#########.#.#.###.#.#.#.#.#####.#.###.#.###.#.#.#####.#
#.#.#...#...#.....#.#...#...#.......#...........#.#...#.....#.#.....#...#...#...#.....#.........#.#...#.#.#...#.......#.#...#.#.....#.......#
#.#.###.###.#.#####.#.#.#.#.#####.#######.#######.#.###.#####.#.#########.#.#.###.#####.#########.###.#.#.#.#######.#####.###.#.#.#########.#
#.#...#.....#.....#.#.#.#.......#.......#.#.....#...#...#.....#...#.......#...#...#.....#...#.......#.....#.#.....#.#...#...#...............#
#####.#####.#.#####.#.#########.#######.###.###.#.#######.#######.###.#.#####.#.###.#####.#.#.#.###.#######.###.#.###.#.#.#.#.###.#.#.###.###
#...#.....#.#.#.....#.........#...#.....#.....#.#.........#.....#.#.....#...#.#.#.........#...#...#.#...........#.....#.#.#.#.#...#.....#...#
#.#.#####.#.###.###.#.#.#.#.#.###.#.#####.###.#.#####.#########.#.#.###.#.#.#.#.#####.###########.#.#.#.###############.#.#.#.###.#######.#.#
#.#.......#.#...#...#.#.#...#...#.#.#.....#...#.....#.#.......#.....#...#.#...#.......#.....#.#...#.#.#.......#.......#...#.#.....#.....#.#.#
#.#.#######.#.###.#.###.#.#.#####.#.#.#######.#####.#.#.#####.#.#########.###.#########.###.#.#.###.#.#######.###.#.#######.#####.#.###.###.#
#.#.#.....#...#...#...#.#.#.......#.#.......#.....#.#.#.#...#.#.#.......#.#...#.......#...#...#.#.....#.....#...#.#...............#.#.......#
#.###.###.#####.#####.#.#.#########.#######.#####.#.###.#.###.###.#####.#.#.###.#.#####.#.#####.#######.###.###.#.###############.#.#########
#.....#.#.......#.....#.#...#.......#.#.....#...#.#.....#...#.#...#...#.#.#.....#.......#.............#.#.#.....#.#...........#...#...#.....#
#.#####.#########.#.###.###.#.#####.#.#.#####.#.#.#########.#.#.#####.#.#.#####.#####################.#.#.#######.#######.###.#.#####.#.#.#.#
#.....#.......#...#.#.......#.#.......#.#.....#.#.#.......#.#...#.....#...#...#...#.................#...#.....#.#.#.......#...#.....#.....#.#
#####.#.#.###.#.#.#.#.#####.#.#######.#.#.#.#.#.#.#.###.#.#.#####.###.#####.#.#####.###############.#######.#.#.#.#.#######.#####.#######.#.#
#...#.#.#.#...#.#.....#...#...#...#...#.#...#.#.#...#.#.#.....#...#.....#...#...#...#.......#.....#.......#.#...#.#.#.......#.....#.......#.#
###.#.#.#.###.#.#######.#.#####.#.#####.#####.#.#.###.#.#####.#.#.#####.#.#####.#.###.###.#.#####.#######.#.###.#.#.###.#.#.#.#.###.#####.#.#
#...#.#.#...#.#.........#.....#.#.............#.#.#...#.#...#...#...#...#.....#.#.#...#.#.#.............#.#...#.#.#...#.#.#...#...#.#...#...#
#.###.#####.#################.#.#####.#######.#.#.#.#.#.#.###.#####.#.#######.#.#.#.###.#.###.#######.###.###.###.###.#.#.#.#####.#.#.#.#.#.#
#...#.....#...#...#...........#.#.......#.......#...#.#.#...#.#...#.#...#...#.#...#.....#.#...#...........#...#...#...#.#.#...#...#.#.#...#.#
#.#.#####.#.#.#.#.#.###########.#.#.#####.#############.#.#.#.#.#.#.#.#.#.#.#.###.###.###.#####.###########.###.###.###.#.#####.###.#.#.###.#
#.#.......#.#...#.#.............#.#.#...#.#.............#.#.#.#.#...#.....#.#...#.....#...#.....#.......#.......#...#...#.#.....#...#.#.....#
#.#########.###.#.###############.###.#.#.###.#######.#####.#.#.#####.#########.#.#####.###.#####.###.###.#######.###.#.#.#.###.#.#####.#####
#.#.#.....#.#.#...#.............#...#.#.#.#...#...#.....#...#...#.....#.........#.....#.#...#...#.#.#.............#...#.#.#.#...#.#...#...#.#
#.#.#.#.###.#.#.###.#####.#.#.#####.#.#.#.#.###.###.#.#.#.#.#.###.###.#.#.#########.###.#.###.#.#.#.###############.#.#.#.#.#####.#.#.###.#.#
#.#...#.......#.......#...#...#...#...#...#.#...#.....#...#...#...#.....#.......#.......#.#...#.#...#.........#.#...#.#.#.#.#...#...#.#.#...#
#.###.#######.#######.#.###.###.#.#########.#.###.###.#####.###.#########.#####.#.###.###.###.#.#####.#######.#.#.###.###.#.#.#.#####.#.###.#
#...#.#...#.#.....#.#.#...#...#.#...#.#.....#.......#.........#...#...#.#.......#.#.#.....#...#...#...#.....#.#.#.#.#.....#...#.#...#.#.....#
###.#.#.#.#.#.###.#.#.###.###.#.#.#.#.#.###.#.###################.#.#.#.#.#.###.#.#.###.###.#####.#.###.#####.#.#.#.#######.###.#.#.#.#.#####
#...#...#...#.#.#.#.#...#...#.#.#.#.#.....#.#.#.........#...#...#...#.#.#.#...#.#.#...#.....#...#...#.........#...#.......#...#.#.#...#...#.#
#.#########.#.#.#.#.###.###.###.#.#.#######.###.#######.#.#.#.#.#.###.#.#####.#.#.#.#.#.###.#.#.###.#.#########.#########.#.###.#.#######.#.#
#.........#.#.#.#.#.......#.......#.......#.....#.#...#.#.#.#.#.......#.#...#.#...#.#.#...#.#.#.......#.........#.......#...#...#.....#.....#
#########.#.#.#.#.#########.#####.#######.#.#.###.#.#.#.#.#.#.#######.#.#.#.#.###.#.#.#####.#.#########.#####.###.#.#.#.#####.#######.#####.#
#.......#.#.#.#...........#.....#.#.....#...#.....#.#.#...#.#.....#...#...#.#.......#.#...#.#.#.....#...#...#...#.#.#.#.....#.#.....#.....#.#
#.#######.#.#.#######.###.#.#####.#.#######.#######.#.#.#.#.#####.###.#####.#########.#.#.#.#.#.###.#.#.#.#.###.###.#.#####.#.#.#.#######.#.#
#.........#.#.....#.......#.#.....#.#.......#.......#...#.#.....#...#.....#.......#...#.#.#.#...#.#.#.#.#.#.#.......#.......#...#.....#...#.#
#.#########.#.#.#.#####.#####.#####.#.#######.#########.#.#####.#.#.#############.#.###.#.#.#####.#.#.#.#.#.#######.#######.#.#####.###.#####
#...#.....#.....#.....#.......#.#.....#...#.....#.....#.#.#...#.#.#...........#...#.....#...#.......#.#.#.#...#.....#.....#.#.#...#.#...#...#
###.#.#.#####.#.#####.#########.#.#######.#.###.#.#####.#.#.###.###########.#.#.#############.#.#####.#.#.###.#####.#.###.#.###.#.#.#.###.#.#
#...#.#.............#...#...............#...#...#.........#...............#...#.#.....#.....#.#...#.....#.#...#...#.#...#.#.....#.#.#.....#.#
#.###.#######.#####.###.#####.#.#######.#####.###.#######.#.###########.#.#.#.#.###.#.#.###.#.#.#.#.#####.#.#.#.#.###.#.#.#######.#.#######.#
#...#.....#...........#.............#.........#.#.#.....#.#.#...........#...#.#.....#.#.#...#...#.#.....#.#...#.#.....#.#.#.#.............#.#
###.###.###.#.###.###.#######.#####.#.#########.#.###.#.#.#.#.#.#.#####.#############.#.#######.#.###.###.#.###.#####.#.#.#.#.#############.#
#...#...#...#...#...#.#.....#.#.....#.#...#...#.......#.#.#.#.#.#.#.....#...........#.#.#.......#.#.#.#...#.....#...#.#...#...#.#.........#.#
#.#######.#.#.#.###.#.#.###.###.#####.#.#.#.#.#.#########.###.#.#.#.###.#.###.#######.#.#.#####.#.#.#.#.#####.###.#.#.#.###.###.#.#######.#.#
#...........#.#...#.#.#.#.#...#.#...#.#.#...#.#.#.#...#...#...#.#.#.#.#.#.#.#.#.......#.#.....#...#...#.#.....#...#.#...#.......#.#.....#...#
#.#.#.#.###.#.#.#.#.###.#.###.#.#.#.###.#.#.#.#.#.#.#.#.###.###.#.#.#.#.#.#.#.#.#######.#####.#########.#.#####.###.#.#######.###.###.#.###.#
#...#...#.#.....#.#.....#.#.....#.#.....#.#.#.....#.#.#.......#...#.#.#.#...#...#...#.......#.#.........#.#...#.#...#.......#.#...#...#.#...#
#########.#.###.#.#######.#.#####.#######.#.#####.#.#.###########.#.#.#.###.#####.#.#.#.#####.#.###.#.#####.#.#.#.#########.###.###.###.#.###
#.......#...#...#.#.....#.....#...#.......#...#.....#...........#.#.#.....#...#.#.#.#.........#...#.#.#.....#...#.........#...#.#...#...#.#.#
#.#.#####.###.###.#####.#.#####.#####.###.#####.###############.###.#######.#.#.#.#.#.###########.#.###.#################.###.#.#.#######.#.#
#.#...#...#...#.#...#...#.#.#...#.....#...#.....#.............#...#.#.......#.....#.#.#.........#.#.....#...............#.#.......#.....#.#.#
#.###.#.###.###.###.#.###.#.#.#####.###.###.#######.#######.#####.#.#.#####.#.#####.#.#####.#####.#######.###.#######.###.#.###.#.#.###.#.#.#
#.#.#.#...#...#...#.#.....#.#...#...#...#...#.....#...#.....#.......#.#.....#.....#.#...#...#...#.#...#...#...#.....#.#...#.....#.....#.#.#.#
#.#.#.#.#####.#.###.#.#####.###.#.###.#####.#.#.#.###.#.#####.#####.#.#.###.###.#.#.###.#.###.#.#.#.#.#.#.#####.###.#.#.#.###########.#.#.#.#
#.......#...#.#.....#.#.......#.#.........#.....#.#.#.#.#.....#...#.#.#.........#.#.....#.....#.....#.#.#.......#.#.#...#.#.......#.#.#...#.#
#.#.#####.#.#.#.#####.#.###.###.#########.#######.#.#.#.#.#####.#.#.#.###.#######.#.###.#.#####.#####.#.#########.#.#.#.###.#####.#.#.#####.#
#.#.....#.#...#.....#...#...#...#...#...#.........#...#.....#...#.#.#...#...#.....#.#...#.#...#.....#.#...........#.#.#.........#.#...#.....#
#.###.#.#.#########.#######.#.###.#.###.###.#########.#####.#.###.#####.###.#.#####.#.###.#.#.#.###.#.#.#########.#.###########.#.#.#####.#.#
#.....#.#.#...#...#.......#.#.....#.#.....#.#...........#.....#.#.....#...#...#.....#.#.#.#.#.#...#...#.#.......#.#.......#...#.#.#.....#.#.#
#########.#.#.#.#.#####.#.#.#######.#.#####.#.#########.#.###.#.#####.###.#####.#.###.#.#.###.###.###.###.#####.#.###.#.###.#.###.#####.###.#
#.........#.#...#.....#...#.......#.#.....#.#.#.....#.#.#.....#...#.#.#...#...#.#.#...#.#.#.....#...#.#...#.....#.#.....#...#.....#...#.#...#
#.#########.#######.#.#.###.#####.#.#####.#.#.###.#.#.#.###.###.#.#.#.#.###.#.#.#.#.###.#.#.###.###.#.#.###.#.#####.#####.#######.#.#.#.#.#.#
#.....#...#.....#.#.#.#.#.....#.#.#.........#.#...#...#...#.#...#...#.#.#...#.....#...#.#...#.#.#.#.#.#...#.#.#.....#.....#...#...#.#.#...#.#
#####.#.#######.#.#.###.###.#.#.#.#.###.#.###.#.###.#.###.#.#.#####.#.#.#.#.#####.###.#.#####.#.#.#.#.###.#.#.###.#.#.#####.#.#####.#.#####.#
#.....#...#.....#.#.......#.#.#...#...#...#...#.....#...#.#...#.....#...#.#...#...#.#.#.....#.....#.....#.#.#.....#.#.#...#.................#
#.#######.#.#####.###.#.#.#.#.###.###.###.#.#######.#####.#####.#############.#.#.#.#.###.###.#########.#.#.#.#####.#.#.#.#.###########.#.#.#
#.#.......#...#.....#.....#.#...#...#.#...#.....#.......#.....#.#...#.....#...#.....#...#.......#...#.#.....#.#...#.#.#.#...................#
#.###.###.###.#.###.###########.###.###.#######.#.###.#.#.#####.#.###.#.#.#.###.#######.#.#######.#.#.#####.#.#.#.###.#.#####.#####.#####.###
#...........#.#...#.....#.......#.....#.......#.#.....#.#.#.....#...#.#.#...#.....#.....#.#...#...#.#...#...#.#.#.#...#.....#.............#.#
#.#.#####.#.#.###.#####.#.###########.#.#.###.#.#######.#.#.#######.#.#.#####.#####.#####.###.#.###.#.###.#.#.#.#.#.#.###.#.###.#.###.#####.#
#.#.....#...#.....#...#.#.........#.#.#.#...........#...#.#.......#...#...#.....#...#...#.....#.#...#...#...#.#.#.#.#.#.....#...#.#.#.#.....#
#.###.#.###########.###.#.#######.#.#.###.#.#######.#.#.#.#######.#######.#.#####.###.#.#######.#.###.#.#.#.#.#.#.#.###.#####.#.#.#.#.#.###.#
#...#.#.#.....#.....#...#...#...#.#.......#.#.....#...#.#.......#.......#.#...#...#...#.........#.#.#.#.#.#...#.#.#...........#.#.#.#.#...#.#
###.#.#.#.#.#.#.#.###.#######.#.#.###.#.#####.#.#######.#######.#######.#.#####.#####.###########.#.#.#.#.#####.#.###############.#.#.#.###.#
#.....................#.......#.#...#...#.....#.......#.......#.......#.#.......#...#...........#.#...#.#.#.#...#.....#...#.......#.#.#.#...#
#.#########.###.#######.#######.###.#####.#########.#.#######.#.#######.#.#######.#.#######.###.#.#.#.#.#.#.#.#######.#.#.#.#######.#.#.#.###
#.......#...#...#.....#.#.....#.....#.....#...#.....#.#.....#.#.........#.........#.....#.......#.#.#...#...#.#.......#.#.#.#.#.....#.#.#...#
#.#####.#.###.###.###.#.#.###.#####.#.#####.###.#######.###.#.#######.#####.###########.#.#######.#.#.#####.#.#.#.###.#.#.#.#.#.###.#.#####.#
#.#...#...........#.#...#.#.....#...#.......#.......#...#...#...#.....#.....#.......#.....#.....#.#.#.......#.#.#.....#.#.#.#.....#...#.....#
#.#.#.#.#.#####.###.#####.#######.#####.###.#.###.#.#.###.#.#.#.###.#.###.###.#####.#########.#.#.###.#######.#.#.#####.#.#.#########.#.###.#
#.#.#...#...#...#.......#.#.....#...#.....#.#...#.#.#.....#.#...#...#...#.#...#...#.#...#.....#.#...#.#.#...#...#.....#.#.#.........#...#.#.#
###.#.#####.#.###.###.#.#.#.###.###.#.#####.###.#.#.###.#.###.###.#####.#.#.###.#.#.#.#.###.#######.#.#.#.#.###.#####.#.#.#.#######.#####.#.#
#...#.#...#...#...#.#.#.#.#...#...#...#...#.#.....#...#.#.....#.....#...#.#.#...#...................#.#.#.#.....#...#.#.#.#.......#.#.#...#.#
#.#.###.#.#####.###.#.#.#.#.#.###.#.#.#.#.#.#.#####.#.#.#########.#.#.#####.#.#.#########.###.#.#####.#.#.#######.###.#.#.#####.###.#.#.#.#.#
#.#.#...#.#.#...#...#.#...#.....#.......#.#.......#.#.#.#...#...#.#.#.......#.#.#.......#...#.#.#...#...#...#.........#.#.....#.#...#...#...#
#.###.###.#.#.###.#.#.#######.#########.#.#.#.###.#.###.#.#.#.#.###.#########.###.#####.###.#.#.#.#.#######.#.#########.#####.###.###.#######
#...#...#.#...#...#.#.#.......#.....#.............#...#...#...#...#...#.....#.....#...#...#.#.#...#...#.....#.#.......#.#.....#...#...#...#.#
#.#.#.###.#.#######.#.#.#######.###.#.###.#.#.#######.###########.###.#####.#.#####.#.###.#.#.###.###.#.#####.#####.#.#.#.#.###.#####.#.#.#.#
#.#...#...#.........#...#.....#...#...#.#...#.....................#...#.....#...#...#.#...#.#.......#.#.....#...#...................#...#...#
#.#####.#########.#####.#.###.###.#####.###.#.###.#.#.#####.#.#.###.###.###.###.#####.#.###.#.#######.#####.###.#.###.###.###.#####.#######.#
#.....#...#.......#...#...#.....#.#.......#.......#.#.#.......#.....#...#.....#.#.....#...#.#.......#.....#...#...#...#...#.#...#...#.#.....#
#####.###.#.#######.#.#####.#####.#.#.###.#.#.#####.#.###.###########.#########.#.###.###.#.#.#####.#####.#.#.#####.###.#.#.###.#.###.#.#####
#...#.#...#.#...#...#.....#...#...#.#.#.#...........#...#.#.......#...........#...#.#.#.#...#.#...#.....#.#.#.#...#.#...#.....#.#.#.....#...#
#.###.#.#####.#.#.#######.#####.#####.#.###.#######.###.###.#####.#.#########.#####.#.#.#####.###.#.#####.###.#.###.#.###.#.###.#.#.#####.#.#
#S......................#.............#...............#.........#...........#.........#...........#...........#.......#...#.......#.......#.#
#############################################################################################################################################
"""
